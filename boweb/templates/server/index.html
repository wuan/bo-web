<!doctype html>
<html>
<title>Server Overview</title>
{% include 'includes/head.html' %}
<link rel="stylesheet" href="http://openlayers.org/en/v3.0.0/css/ol.css" type="text/css">
<style>
    .map {
        height: 800px;
        width: 100%;
    }
</style>
<script src="http://openlayers.org/en/v3.0.0/build/ol.js" type="text/javascript"></script>

<body role="document">

<h1>Server Overview</h1>

<h2>Cluster Map</h2>

<div id="map" class="map"></div>
<input type="button" name="redraw" onClick="vector_layer.getSource().load()"/>

<script type="text/javascript">

    var colors = [
        'rgba(228, 249, 249, 1.0)',
        'rgba(216, 243, 96, 1.0)',
        'rgba(223, 188, 81, 1.0)',
        'rgba(228, 128, 68, 1.0)',
        'rgba(231, 60, 59, 1.0)',
        'rgba(184, 46, 45, 1.0)',
    ];

    var styleFunction = function (feature, resolution) {
        timedelta = feature.getProperties().timedelta;

        return [new ol.style.Style({
            stroke: new ol.style.Stroke({
                color: colors[timedelta],
                width: (timedelta === 0 ? 2 : 1)
            })
        })]
    };

    var vector_layer = new ol.layer.Vector({
        projection: 'EPSG:3857',
        defaultProjection: 'EPSG:4326',
        source: new ol.source.GeoJSON({
            url: './data/current'
        }),
        style: styleFunction,
        reloadInterval: 1000
    });

    var map = new ol.Map({
        target: 'map',
        layers: [
            new ol.layer.Tile({
                source: new ol.source.MapQuest({layer: 'sat'})
            }),
            vector_layer
        ],
        view: new ol.View({
            center: ol.proj.transform([11, 49], 'EPSG:4326', 'EPSG:3857'),
            zoom: 5
        })
    });
</script>


</body>
</html>
